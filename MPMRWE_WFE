---
title: "MPM RWE without feature enginering"
output: html_document
---
Load packages for project
```{r setup, include=FALSE}
options(width = 120)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
library(tidyverse)
library(skimr)
library(tidymodels)
library(matrixStats)
library(vip)
#library(kernlab)
#library(doParallel)
library(discrim)
library(stacks)
#library(kknn)
```


# Loading data and data curation
```{r load_data}
## Synthetic data for analysis
dfraw <- read_csv("/users/home/candwei/pm_master/cll_tim_compound_infec_n.csv") %>% 
  rename("id" = "...1") 
```

```{r}
df <- dfraw %>% 
  select(-c(id, Patient_id, INFEC_days_after_diag)) %>% 
  mutate(INFEC_after_diag_num = INFEC_after_diag) %>%
  mutate(INFEC_after_diag = factor(INFEC_after_diag, levels = c("1", "0")))

colnames(df)[166:169] <- c("NAT_min","NAT_max","NAT_sd","NAT_mean")
```



```{r}
set.seed(42)

# Create random samples of the rows with 20% set aside for testing
df_split <- df %>% 
  initial_split(prop = 0.8)

# Extract the datasets
df_other <- training(df_split)
df_test  <- testing(df_split)

# For the non testing set we create a 75/25 train/validation split
# The original data is then split into 60/20/20 proportions for training, validation and testing
df_val <- vfold_cv(df_other, v = 5)
```

# Define models

## Set overall recipe
```{r}
metric <- metric_set(roc_auc)

ctrl_grid <- control_stack_grid()
ctrl_res <- control_stack_resamples()

size_grid = 50

cll_rec <-
  recipe(INFEC_after_diag ~ ., data = df_other) %>%

  step_impute_linear(BETA2M_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
  step_impute_linear(BETA2M_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
  step_impute_linear(BETA2M_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(BETA2M_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(THR_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(THR_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(THR_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(THR_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AEC_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AEC_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AEC_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AEC_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(URAT_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(URAT_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(URAT_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(URAT_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(TRANS_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(TRANS_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(TRANS_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(TRANS_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(PSA_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PSA_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PSA_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PSA_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MIC_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MIC_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MIC_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(SMUDGE_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(SMUDGE_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(SMUDGE_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(SMUDGE_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(AMY_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AMY_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AMY_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(AMY_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MIC_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%   
  
    step_impute_linear(MCV_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCV_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCV_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCV_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PROM_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PROM_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PROM_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(PROM_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CRP_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CRP_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CRP_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CRP_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(GLUC_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(GLUC_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(GLUC_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(GLUC_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREA_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREA_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREA_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREA_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREAK_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREAK_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREAK_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(CREAK_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(HEMA_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(HEMA_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(HEMA_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(HEMA_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(EGFR_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age)) %>%
  
    step_impute_linear(EGFR_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(EGFR_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(EGFR_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(LDH_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(LDH_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(LDH_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(LDH_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(MCH_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCH_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCH_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCH_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(MCHC_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCHC_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCHC_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(MCHC_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(ALB_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age)) %>%
  
    step_impute_linear(ALB_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(ALB_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(ALB_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(ALP_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(ALP_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(ALP_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(ALP_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(INR_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(INR_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(INR_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(INR_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
      step_impute_linear(NAT_min,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(NAT_max,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(NAT_sd,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
    step_impute_linear(NAT_mean,
                     impute_with = imp_vars(Binet_Stage_A,Binet_Stage_B,Binet_Stage_C,IGHV_unmut_Mutated,IGHV_unmut_Unmutated,IGHV_unmut_NA,ECOG_0,ECOG_1,ECOG_2,ECOG_3,ECOG_4,ECOG_5,ECOG_NA,FamCLL_Yes,FamCLL_No,FamCLL_NA,Beta2m_Yes,Beta2m_No,Beta2m_NA,CD38_Yes,CD38_No,CD38_NA,ZAP70_Yes,ZAP70_No,ZAP70_NA,Gender_M,Gender_F,del13_Yes,del13_No,del13_NA,tri12_Yes,tri12_No,tri12_NA,del11_Yes,del11_No,del11_NA,Age,LEUK_min,LEUK_max,LEUK_sd,LEUK_mean,HAEM_min,HAEM_max,HAEM_sd,HAEM_mean,BASO_min,BASO_max,BASO_sd,BASO_mean,ALC_min,ALC_max,ALC_sd,ALC_mean,EOS_min,EOS_max,EOS_sd,EOS_mean,NEU_min,NEU_max,NEU_sd,NEU_mean,BLAST_min,BLAST_max,BLAST_sd,BLAST_mean,MYEL_min,MYEL_max,MYEL_sd,MYEL_mean,METAMYEL_min,METAMYEL_max,METAMYEL_sd,METAMYEL_mean, INFEC_n, INFEC_after_diag_num)) %>%
  
  step_rm(INFEC_after_diag_num) %>%
  step_zv(all_predictors()) %>%           # Remove variables with no variation
  step_normalize(all_predictors())
  

cll_wflow <-
  workflow() %>%
  add_recipe(cll_rec)
```


## LR
```{r}
lr_mod_wfe <- 
  logistic_reg(penalty = tune(), mixture = tune()) %>% 
  set_mode("classification") %>%
  set_engine("glmnet")

lr_wflow_wfe <-
  cll_wflow %>%
  add_model(lr_mod_wfe)

lr_params_wfe <- 
  dials::parameters(
    penalty(),
    mixture()
  )

lr_grid_wfe <- 
  dials::grid_max_entropy(
    lr_params_wfe, 
    size = size_grid
  )

lr_res_wfe <- 
  tune_grid(
  object = lr_wflow_wfe,
  resamples = df_val,
  grid = lr_grid_wfe,
  control = ctrl_grid,
  metrics = metric
  )

saveRDS(lr_res_wfe, "/users/home/candwei/lr_res_wfe")
```

We can print the metrics from the model training using the collect_metrics command.
```{r}
lr_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(lr_res_wfe)

```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
lr_best_wfe <- 
  lr_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

lr_best_wfe

# Alternatively the sorting and slicing may be done using
# show_best(lr_res)
```

Finally we can plot the ROC for the best model
```{r}
lr_auc_wfe <- 
  lr_res_wfe %>% 
  collect_predictions(parameters = lr_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Elastic Net")

autoplot(lr_auc_wfe)
```

## RF
```{r}
#cores <- parallel::detectCores()
rf_mod_wfe <-
  rand_forest(
    mtry = tune(),
    min_n = tune(),
    trees = tune(),
  ) %>% set_mode("classification") %>%
  set_engine("ranger"#, 
             #num.threads = cores
             )

rf_wflow_wfe <-
  cll_wflow %>%
  add_model(rf_mod_wfe)

cll.mtry = select(df,-INFEC_after_diag)
finalize(mtry(),cll.mtry)

rf_params_wfe <- 
  dials::parameters(
    dials::mtry(),
    min_n(),
    trees()
  )

rf_params_wfe <-
  rf_params_wfe %>%
  update(mtry = finalize(mtry(), df %>% select(-INFEC_after_diag)))

rf_grid_wfe <- 
  dials::grid_max_entropy(
    rf_params_wfe, 
    size = size_grid
  )

rf_res_wfe <- 
  tune_grid(
    object = rf_wflow_wfe, 
    resamples = df_val, 
    grid = rf_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(rf_res_wfe, "/users/home/candwei/rf_res_wfe")
```

Print the top performing models
```{r}
show_best(rf_res_wfe)
```

We can plot the performance against the tuning parameters
```{r}
autoplot(rf_res_wfe)
```

ROC for the best model
```{r}
rf_best_wfe <- 
  rf_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

rf_best_wfe

rf_auc_wfe <- 
  rf_res_wfe %>% 
  collect_predictions(parameters = rf_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Random forrest")

autoplot(rf_auc_wfe)
```


## SVM
```{r}
svm_mod_wfe <-
  svm_poly(
    cost  = tune(),
    degree = tune(),
  ) %>% set_mode("classification") %>%
  set_engine("kernlab")

svm_wflow_wfe <-
  cll_wflow %>%
  add_model(svm_mod_wfe)


svm_params_wfe <- 
  dials::parameters(
    cost(),
    degree()
  )

svm_grid_wfe <- 
  dials::grid_max_entropy(
    svm_params_wfe, 
    size = size_grid
  )
svm_grid_wfe$degree = as.integer(svm_grid_wfe$degree)

svm_res_wfe <- 
  tune_grid(
    object = svm_wflow_wfe, 
    resamples = df_val, 
    grid = svm_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(svm_res_wfe, "/users/home/candwei/svm_res_wfe")

```

We can print the metrics from the model training using the collect_metrics command.
```{r}
svm_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(svm_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
svm_best_wfe <- 
  svm_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#svm_best
show_best(svm_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
svm_auc_wfe <- 
  svm_res_wfe %>% 
  collect_predictions(parameters = svm_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "SVM")

autoplot(svm_auc_wfe)
```

## SVM with radial basis
```{r}
svm_r_mod_wfe <-
  svm_rbf(
    cost  = tune(),
    rbf_sigma = tune(),
  ) %>% set_mode("classification") %>%
  set_engine("kernlab")

svm_r_wflow_wfe <-
  cll_wflow %>%
  add_model(svm_r_mod_wfe)


svm_r_params_wfe <- 
  dials::parameters(
    cost(),
    rbf_sigma()
  )

svm_r_grid_wfe <- 
  dials::grid_max_entropy(
    svm_r_params_wfe, 
    size = size_grid
  )

svm_r_res_wfe <- 
  tune_grid(
    object = svm_r_wflow_wfe, 
    resamples = df_val, 
    grid = svm_r_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(svm_r_res_wfe, "/users/home/candwei/svm_r_res_wfe")
```
We can print the metrics from the model training using the collect_metrics command.
```{r}
svm_r_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(svm_r_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
svm_r_best_wfe <- 
  svm_r_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#s best svm_r
show_best(svm_r_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
svm_r_auc_wfe <- 
  svm_r_res_wfe %>% 
  collect_predictions(parameters = svm_r_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "SVM radial")

autoplot(svm_r_auc_wfe)
```

## extrem gradient boost
```{r}
xgb_mod_wfe <-
  boost_tree(
    trees = tune(),
    min_n = tune(),
    tree_depth = tune(),
    learn_rate = tune(),
    loss_reduction = tune()) %>% 
  set_engine("xgboost") %>%
  set_mode("classification")

xgb_wflow_wfe <-
  cll_wflow %>%
  add_model(xgb_mod_wfe)


xgb_params_wfe <- 
  dials::parameters(
    trees(),
    min_n(),
    tree_depth(),
    learn_rate(),
    loss_reduction()
  )

xgb_grid_wfe <- 
  dials::grid_max_entropy(
    xgb_params_wfe, 
    size = size_grid
  )

xgb_res_wfe <- 
  tune_grid(
    object = xgb_wflow_wfe, 
    resamples = df_val, 
    grid = xgb_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(xgb_res_wfe, "/users/home/candwei/xgb_res_wfe")

```

We can print the metrics from the model training using the collect_metrics command.
```{r}
xgb_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(xgb_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
xgb_best_wfe <- 
  xgb_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#svm_best
show_best(xgb_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
xgb_auc_wfe <- 
  xgb_res_wfe %>% 
  collect_predictions(parameters = xgb_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "xgboost")

autoplot(xgb_auc_wfe)
```


## Multilayer perceptron
```{r}
mlp_mod_wfe <- 
    mlp(
      hidden_units = tune(),
      penalty = tune(),
      epochs = tune()
      ) %>% 
  set_engine("nnet", trace = 0,MaxNWts=10000) %>% 
  set_mode("classification")

mlp_wflow_wfe <-
  cll_wflow %>%
  add_model(mlp_mod_wfe)


mlp_params_wfe <- 
  dials::parameters(
    hidden_units(),
    penalty(),
    epochs()
  )

mlp_grid_wfe <- 
  dials::grid_max_entropy(
    mlp_params_wfe, 
    size = size_grid
  )

mlp_res_wfe <- 
  tune_grid(
    object = mlp_wflow_wfe, 
    resamples = df_val, 
    grid = mlp_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(mlp_res_wfe, "/users/home/candwei/mlp_res_wfe")

```

We can print the metrics from the model training using the collect_metrics command.
```{r}
mlp_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(mlp_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
mlp_best_wfe <- 
  mlp_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#mlp_best
show_best(mlp_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
mlp_auc_wfe <- 
  mlp_res_wfe %>% 
  collect_predictions(parameters = mlp_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Multilayer Perceptron")

autoplot(mlp_auc_wfe)
```

## Naive Bayes
```{r}
nb_mod_wfe <- 
  naive_Bayes(
    smoothness = tune(),
    Laplace = tune()
    ) %>% 
  set_engine("naivebayes") %>%
  set_mode("classification")

nb_wflow_wfe <-
  cll_wflow %>%
  add_model(nb_mod_wfe)


nb_params_wfe <- 
  dials::parameters(
    smoothness(),
    Laplace()
  )

nb_grid_wfe <- 
  dials::grid_max_entropy(
    nb_params_wfe, 
    size = size_grid
  )

nb_res_wfe <- 
  tune_grid(
    object = nb_wflow_wfe, 
    resamples = df_val, 
    grid = nb_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(nb_res_wfe, "/users/home/candwei/nb_res_wfe")

```

```{r}
nb_res_wfe %>% 
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(nb_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
nb_best_wfe <- 
  nb_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

show_best(nb_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
nb_auc_wfe <- 
  nb_res_wfe %>% 
  collect_predictions(parameters = nb_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "naive Bayes")

autoplot(nb_auc_wfe)
```

# Bagged tree
```{r}
bag_mod_wfe <- 
  baguette::bag_tree(
           min_n = tune(),
           class_cost = tune()) %>% 
  set_engine("C5.0") %>%
  set_mode("classification")

bag_wflow_wfe <-
  cll_wflow %>%
  add_model(bag_mod_wfe)


bag_params_wfe <- 
  dials::parameters(
    min_n(),
    baguette::class_cost()
  )

bag_grid_wfe <- 
  dials::grid_max_entropy(
    bag_params_wfe, 
    size = size_grid
  )

bag_res_wfe <- 
  tune_grid(
    object = bag_wflow_wfe, 
    resamples = df_val, 
    grid = bag_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(bag_res_wfe, "/users/home/candwei/bag_res_wfe")

```


We can print the metrics from the model training using the collect_metrics command.
```{r}
bag_res_wfe %>%
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(bag_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
bag_best_wfe <- 
  bag_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#bag best
show_best(bag_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
bag_auc_wfe <- 
  bag_res_wfe %>% 
  collect_predictions(parameters = bag_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Bagged trees")

autoplot(bag_auc_wfe)
```
# decision tree
```{r}
dec_mod_wfe <- 
  decision_tree(
           min_n = tune(),
           cost_complexity = tune(),
           tree_depth = tune()) %>% 
  set_engine("rpart") %>%
  set_mode("classification")

dec_wflow_wfe <-
  cll_wflow %>%
  add_model(dec_mod_wfe)


dec_params_wfe <- 
  dials::parameters(
    min_n(),
    cost_complexity(),
    tree_depth()
  )

dec_grid_wfe <- 
  dials::grid_max_entropy(
    dec_params_wfe, 
    size = size_grid
  )

dec_res_wfe <- 
  tune_grid(
    object = dec_wflow_wfe, 
    resamples = df_val, 
    grid = dec_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(dec_res_wfe, "/users/home/candwei/dec_res_wfe")
```


We can print the metrics from the model training using the collect_metrics command.
```{r}
dec_res_wfe %>%
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(dec_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
dec_best_wfe <- 
  dec_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#bag best
show_best(dec_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
dec_auc_wfe <- 
  dec_res_wfe %>% 
  collect_predictions(parameters = dec_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Decision tree")

autoplot(dec_auc_wfe)
```

# Multivariate adaptive regression splines
```{r}
mars_mod_wfe <- mars(
      num_terms = tune(),
      prod_degree = tune(),
      prune_method = tune()) %>% 
  set_engine("earth", nfold = 5) %>%
  set_mode("classification")

mars_wflow_wfe <-
  cll_wflow %>%
  add_model(mars_mod_wfe)


mars_params_wfe <- 
  dials::parameters(
    num_terms(),
    prod_degree(),
    prune_method()
  )

mars_params_wfe <-
  mars_params_wfe %>%
  update(num_terms = finalize(num_terms(), df %>% select(-INFEC_after_diag)))

mars_grid_wfe <- 
  dials::grid_max_entropy(
    mars_params_wfe, 
    size = size_grid
  )

mars_res_wfe <- 
  tune_grid(
    object = mars_wflow_wfe, 
    resamples = df_val, 
    grid = mars_grid_wfe,
    control = ctrl_grid,
    metrics = metric
  )

saveRDS(mars_res_wfe, "/users/home/candwei/mars_res_wfe")
```


We can print the metrics from the model training using the collect_metrics command.
```{r}
mars_res_wfe %>%
  collect_metrics()
```

We can also plot the performance of all the models as a function of the tuning parameters, to get a quick overview.
```{r}
autoplot(mars_res_wfe)
```

We can select the best model, i.e. combination of penalty and mixture with best AUC, by sorting on the mean AUC value, and "slicing" of the first row.
```{r}
mars_best_wfe <- 
  mars_res_wfe %>% 
  collect_metrics() %>% 
  arrange(-mean) %>% 
  dplyr::slice(1)

#bag best
show_best(mars_res_wfe)
```

Finally we can plot the ROC for the best model
```{r}
mars_auc_wfe <- 
  mars_res_wfe %>% 
  collect_predictions(parameters = mars_best_wfe) %>% 
  roc_curve(INFEC_after_diag, .pred_1) %>% 
  mutate(model = "Multivariate adaptive regression splines")

autoplot(mars_auc_wfe)
```

# Last model
This section demonstrates how to retrain the model on the combined training and validation set, using the optimal tuning parameters, and evaluating the performance on the test set.

## LR
```{r}
# Create model with best parameter
lr_final_mod_wfe <- logistic_reg(penalty = lr_best_wfe$penalty, mixture = lr_best_wfe$mixture) %>% 
  set_engine("glmnet")

# Create final workflow
lr_final_workflow_wfe <- workflow() %>% 
 add_model(lr_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
lr_last_fit_wfe <- last_fit(lr_final_workflow_wfe, split = df_split)
lr_last_fit_wfe %>% collect_metrics()
```

We can print the most important features used for the prediction using the variable importance function. Vip depends on the type of model, so we include the type of variable importance score. For the EN model, which is a paramatric model, we get the model coefficients.

## RF
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
rf_final_mod_wfe <- 
  rand_forest(mtry = rf_best_wfe$mtry, min_n = rf_best_wfe$min_n, trees = rf_best_wfe$trees) %>% 
  set_engine("ranger", importance = "impurity") %>% 
  set_mode("classification")

# Create final workflow
rf_final_workflow_wfe <- workflow() %>% 
 add_model(rf_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
rf_last_fit_wfe <- last_fit(rf_final_workflow_wfe, split = df_split)
rf_last_fit_wfe %>% collect_metrics()
```


## SVM
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
svm_final_mod_wfe <- 
  svm_poly(cost = svm_best_wfe$cost, degree = svm_best_wfe$degree) %>% 
  set_engine("kernlab") %>% 
  set_mode("classification")

# Create final workflow
svm_final_workflow_wfe <- workflow() %>% 
  add_model(svm_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
svm_last_fit_wfe <- last_fit(svm_final_workflow_wfe, split = df_split)
svm_last_fit_wfe %>% collect_metrics()
```



## SVM with radial basis
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
svm_r_final_mod_wfe <- 
  svm_rbf(cost = svm_r_best_wfe$cost, rbf_sigma = svm_r_best_wfe$rbf_sigma) %>% 
  set_engine("kernlab") %>% 
  set_mode("classification")

# Create final workflow
svm_r_final_workflow_wfe <- workflow() %>% 
 add_model(svm_r_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
svm_r_last_fit_wfe <- last_fit(svm_r_final_workflow_wfe, split = df_split)
svm_r_last_fit_wfe %>% collect_metrics()
```


## XGBOOSTING
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
xgb_final_mod_wfe <- 
  boost_tree(min_n = xgb_best_wfe$min_n,tree_depth = xgb_best_wfe$tree_depth, learn_rate = xgb_best_wfe$learn_rate,loss_reduction = xgb_best_wfe$loss_reduction, trees=xgb_best_wfe$trees) %>% 
  set_engine("xgboost") %>% 
  set_mode("classification")

# Create final workflow
xgb_final_workflow_wfe <- workflow() %>% 
 add_model(xgb_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
xgb_last_fit_wfe <- last_fit(xgb_final_workflow_wfe, split = df_split)
xgb_last_fit_wfe %>% collect_metrics()
```


## mlp
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
mlp_final_mod_wfe <- 
  mlp(hidden_units = mlp_best_wfe$hidden_units, penalty = mlp_best_wfe$penalty, epochs = mlp_best_wfe$epochs) %>% 
  set_engine("nnet", trace=0,MaxNWts=10000) %>% 
  set_mode("classification")

# Create final workflow
mlp_final_workflow_wfe <- workflow() %>% 
 add_model(mlp_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
mlp_last_fit_wfe <- last_fit(mlp_final_workflow_wfe, split = df_split)
mlp_last_fit_wfe %>% collect_metrics()
```

##Bagged trees
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
bag_final_mod_wfe <- 
   baguette::bag_tree(
           min_n = bag_best_wfe$min_n,
           class_cost = bag_best_wfe$class_cost)%>% 
  set_engine("C5.0") %>% 
  set_mode("classification")


# Create final workflow
bag_final_workflow_wfe <- workflow() %>% 
 add_model(bag_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
bag_last_fit_wfe <- last_fit(bag_final_workflow_wfe, split = df_split)
bag_last_fit_wfe %>% collect_metrics()
```


## Naive Bayes
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
nb_final_mod_wfe <- 
  naive_Bayes(smoothness = nb_best_wfe$smoothness, Laplace = nb_best_wfe$Laplace) %>% 
  set_engine("naivebayes") %>% 
  set_mode("classification")


# Create final workflow
nb_final_workflow_wfe <- workflow() %>% 
 add_model(nb_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
nb_last_fit_wfe <- last_fit(nb_final_workflow_wfe, split = df_split)
nb_last_fit_wfe %>% collect_metrics()
```


## Decision tree
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
dec_final_mod_wfe <- 
  decision_tree(
    min_n = dec_best_wfe$min_n,
    cost_complexity = dec_best_wfe$cost_complexity,
    tree_depth = dec_best_wfe$tree_depth) %>% 
  set_engine("rpart") %>% 
  set_mode("classification")

# Create final workflow
dec_final_workflow_wfe <- workflow() %>% 
 add_model(dec_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
dec_last_fit_wfe <- last_fit(dec_final_workflow_wfe, split = df_split)
dec_last_fit_wfe %>% collect_metrics()
```

## MARS
```{r}
# Create model with best parameter
# In order to extract the variable importance we need to specify it in set_engine
mars_final_mod_wfe <- 
  mars(
    num_terms = mars_best_wfe$num_terms,
    prune_method = mars_best_wfe$prune_method,
    prod_degree = mars_best_wfe$prod_degree) %>% 
  set_engine("earth") %>% 
  set_mode("classification")

# Create final workflow
mars_final_workflow_wfe <- workflow() %>% 
 add_model(mars_final_mod_wfe) %>% 
  add_recipe(cll_rec)

# Last fit
mars_last_fit_wfe <- last_fit(mars_final_workflow_wfe, split = df_split)
mars_last_fit_wfe %>% collect_metrics()
```

# Create stack
## Create stack
```{r}
cll_st_wfe <- 
  stacks() %>%
  add_candidates(lr_res_wfe) %>%
  add_candidates(rf_res_wfe) %>%
  add_candidates(svm_res_wfe) %>%
  add_candidates(svm_r_res_wfe) %>%
  add_candidates(xgb_res_wfe) %>%
  add_candidates(nb_res_wfe) %>%
  add_candidates(mlp_res_wfe) %>%
  add_candidates(bag_res_wfe) %>%
  add_candidates(dec_res_wfe) %>%
  add_candidates(mars_res_wfe) %>%
  blend_predictions() %>%
  fit_members()

```

## Visualize trade-off between number of members and performance
```{r}
autoplot(cll_st_wfe)
```

## Other visualization showing trade-off vs performance
```{r}
autoplot(cll_st_wfe, type = "members")
```

## Look at penalty 
```{r}
autoplot(cll_st_wfe, type="weights")
```

## Check parameters
```{r}
collect_parameters(cll_st_wfe,"lr_res_wfe")
```

## Predicting new data
```{r}
cll_pred_wfe <-
  df_test %>%
  bind_cols(predict(cll_st_wfe,.,type = "prob"))
  
yardstick::roc_auc(
  cll_pred_wfe,
  truth = INFEC_after_diag,
  contains(".pred_1")
)
```

## compare with individual models
```{r}
cll_pred_wfe <-
  df_test %>%
  select(INFEC_after_diag) %>%
  bind_cols(
    predict(
      cll_st_wfe,
      df_test,
      type = "class",
      members = TRUE
    )
  )
```

## compare members with total
```{r}
map_dfr(
  setNames(colnames(cll_pred_wfe),colnames(cll_pred_wfe)),
  ~mean(cll_pred_wfe$INFEC_after_diag == pull(cll_pred_wfe, .x))
) %>%
  pivot_longer(c(everything(),-INFEC_after_diag))
```

## Callibration plots

## EN
### extract models from last fit
```{r}
lr_final_wfe = lr_last_fit_wfe %>%
  pluck(".workflow", 1)


df_lr_wfe = bind_cols(
  df_test,
  predict(lr_final_wfe, df_test),
  predict(lr_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_lr_wfe$bs =  (df_lr_wfe$.pred_1 - df_lr_wfe$INFEC_after_diag_num)^2
mean(df_lr_wfe$bs)
```

## create calibration plot
```{r}
lr_cp = classifierplots::calibration_plot(df_lr_wfe$INFEC_after_diag, df_lr_wfe$.pred_1)
lr_cp
```
## RF
### extract models from last fit
```{r}
rf_final_wfe = rf_last_fit_wfe %>%
  pluck(".workflow", 1)


df_rf_wfe = bind_cols(
  df_test,
  predict(rf_final_wfe, df_test),
  predict(rf_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_rf_wfe$bs =  (df_rf_wfe$.pred_1 - df_rf_wfe$INFEC_after_diag_num)^2
mean(df_rf_wfe$bs)
```

## create calibration plot
```{r}
rf_cp = classifierplots::calibration_plot(df_rf_wfe$INFEC_after_diag, df_rf_wfe$.pred_1)
rf_cp
```

## SVM
### extract models from last fit
```{r}
svm_final_wfe = svm_last_fit_wfe %>%
  pluck(".workflow", 1)


df_svm_wfe = bind_cols(
  df_test,
  predict(svm_final_wfe, df_test),
  predict(svm_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_svm_wfe$bs =  (df_svm_wfe$.pred_1 - df_svm_wfe$INFEC_after_diag_num)^2
mean(df_svm_wfe$bs)
```

## create calibration plot
```{r}
svm_cp = classifierplots::calibration_plot(df_svm_wfe$INFEC_after_diag, df_svm_wfe$.pred_1)
svm_cp
```
## SVM with radient kernel basis
### extract models from last fit
```{r}
svm_r_final_wfe = svm_r_last_fit_wfe %>%
  pluck(".workflow", 1)


df_svm_r_wfe = bind_cols(
  df_test,
  predict(svm_r_final_wfe, df_test),
  predict(svm_r_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_svm_r_wfe$bs =  (df_svm_r_wfe$.pred_1 - df_svm_r_wfe$INFEC_after_diag_num)^2
mean(df_svm_r_wfe$bs)
```

## create calibration plot
```{r}
svm_r_cp = classifierplots::calibration_plot(df_svm_r_wfe$INFEC_after_diag, df_svm_r_wfe$.pred_1)
svm_r_cp
```

## xgb
### extract models from last fit
```{r}
xgb_final_wfe = xgb_last_fit_wfe %>%
  pluck(".workflow", 1)


df_xgb_wfe = bind_cols(
  df_test,
  predict(xgb_final_wfe, df_test),
  predict(xgb_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_xgb_wfe$bs =  (df_xgb_wfe$.pred_1 - df_xgb_wfe$INFEC_after_diag_num)^2
mean(df_xgb_wfe$bs)
```

## create calibration plot
```{r}
xgb_cp = classifierplots::calibration_plot(df_xgb_wfe$INFEC_after_diag, df_xgb_wfe$.pred_1)
xgb_cp
```

## Naive Bayes
### extract models from last fit
```{r}
nb_final_wfe = nb_last_fit_wfe %>%
  pluck(".workflow", 1)


df_nb_wfe = bind_cols(
  df_test,
  predict(nb_final_wfe, df_test),
  predict(nb_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_nb_wfe$bs =  (df_nb_wfe$.pred_1 - df_nb_wfe$INFEC_after_diag_num)^2
mean(df_nb_wfe$bs)
```

## create calibration plot
```{r}
nb_cp = classifierplots::calibration_plot(df_nb_wfe$INFEC_after_diag, df_nb_wfe$.pred_1)
nb_cp
```

## Multilayer perceptron
### extract models from last fit
```{r}
mlp_final_wfe = mlp_last_fit_wfe %>%
  pluck(".workflow", 1)


df_mlp_wfe = bind_cols(
  df_test,
  predict(mlp_final_wfe, df_test),
  predict(mlp_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_mlp_wfe$bs =  (df_mlp_wfe$.pred_1 - df_mlp_wfe$INFEC_after_diag_num)^2
mean(df_mlp_wfe$bs)
```

## create calibration plot
```{r}
mlp_cp = classifierplots::calibration_plot(df_mlp_wfe$INFEC_after_diag, df_mlp_wfe$.pred_1)
mlp_cp
```

## Bagged trees
### extract models from last fit
```{r}
bag_final_wfe = bag_last_fit_wfe %>%
  pluck(".workflow", 1)


df_bag_wfe = bind_cols(
  df_test,
  predict(bag_final_wfe, df_test),
  predict(bag_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_bag_wfe$bs =  (df_bag_wfe$.pred_1 - df_bag_wfe$INFEC_after_diag_num)^2
mean(df_bag_wfe$bs)
```

## create calibration plot
```{r}
bag_cp = classifierplots::calibration_plot(df_bag_wfe$INFEC_after_diag, df_bag_wfe$.pred_1)
bag_cp
```

## Decision tree
### extract models from last fit
```{r}
dec_final_wfe = dec_last_fit_wfe %>%
  pluck(".workflow", 1)


df_dec_wfe = bind_cols(
  df_test,
  predict(dec_final_wfe, df_test),
  predict(dec_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_dec_wfe$bs =  (df_dec_wfe$.pred_1 - df_dec_wfe$INFEC_after_diag_num)^2
mean(df_dec_wfe$bs)
```

## create calibration plot
```{r}
dec_cp = classifierplots::calibration_plot(df_dec_wfe$INFEC_after_diag, df_dec_wfe$.pred_1)
dec_cp
```

## MARS
### extract models from last fit
```{r}
mars_final_wfe = mars_last_fit_wfe %>%
  pluck(".workflow", 1)


df_mars_wfe = bind_cols(
  df_test,
  predict(mars_final_wfe, df_test),
  predict(mars_final_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_mars_wfe$bs =  (df_mars_wfe$.pred_1 - df_mars_wfe$INFEC_after_diag_num)^2
mean(df_mars_wfe$bs)
```

## create calibration plot
```{r}
mars_cp = classifierplots::calibration_plot(df_mars_wfe$INFEC_after_diag, df_mars_wfe$.pred_1)
mars_cp
```

## EN
### extract models from last fit
```{r}
df_cll_st_wfe = bind_cols(
  df_test,
  predict(cll_st_wfe, df_test),
  predict(cll_st_wfe, df_test, type="prob")
)
```

## calculate Brier score
```{r}
df_cll_st_wfe$bs =  (df_cll_st_wfe$.pred_1 - df_cll_st_wfe$INFEC_after_diag_num)^2
mean(df_cll_st_wfe$bs)
```

## create calibration plot
```{r}
cll_st_cp = classifierplots::calibration_plot(df_cll_st_wfe$INFEC_after_diag, df_cll_st_wfe$.pred_1)
cll_st_cp
```


lr_clp = classifierplots::classifierplots(df_lr_wfe$INFEC_after_diag, df_lr_wfe$.pred_1)
lr_clp

rf_clp = classifierplots::classifierplots(df_rf_wfe$INFEC_after_diag, df_rf_wfe$.pred_1)
rf_clp

svm_clp = classifierplots::classifierplots(df_svm_wfe$INFEC_after_diag, df_svm_wfe$.pred_1)
svm_clp

svm_r_clp = classifierplots::classifierplots(df_svm_r_wfe$INFEC_after_diag, df_svm_r_wfe$.pred_1)
svm_r_clp

xgb_clp = classifierplots::classifierplots(df_xgb_wfe$INFEC_after_diag, df_xgb_wfe$.pred_1)
xgb_clp

nb_clp = classifierplots::classifierplots(df_nb_wfe$INFEC_after_diag, df_nb_wfe$.pred_1)
nb_clp

mlp_clp = classifierplots::classifierplots(df_mlp_wfe$INFEC_after_diag, df_mlp_wfe$.pred_1)
mlp_clp

bag_clp = classifierplots::classifierplots(df_bag_wfe$INFEC_after_diag, df_bag_wfe$.pred_1)
bag_clp

dec_clp = classifierplots::classifierplots(df_dec_wfe$INFEC_after_diag, df_dec_wfe$.pred_1)
dec_clp

mars_clp = classifierplots::classifierplots(df_mars_wfe$INFEC_after_diag, df_mars_wfe$.pred_1)
mars_clp

cll_st_clp = classifierplots::classifierplots(df_cll_st_wfe$INFEC_after_diag, df_cll_st_wfe$.pred_1)
cll_st_clp

